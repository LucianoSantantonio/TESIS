# -*- coding: utf-8 -*-
"""
Análisis por generaciones - Versión corregida sin errores
"""
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np

def clasificar_generacion(edad):
    """Clasifica la edad en generaciones"""
    if 61 <= edad <= 79:
        return 'Baby Boomers'
    elif 45 <= edad <= 60:
        return 'Generación X'
    elif 29 <= edad <= 44:
        return 'Millennials'
    elif 13 <= edad <= 28:
        return 'Generación Z'
    else:
        return 'Otra'
    
etiquetas_x = ['1-H', '2-IA', '3-H', '4-H', '5-IA', '6-IA', '7-IA', '8-H', '9-IA', '10-IA']
# Datos 
respuestas = {
    '1-H':  (6,6,4,8,8,8,6,5,8,7,6,7,6,6,4,4,7,6,7,8,4,6,8,8,8,5,7,5,9,8,5,8,7,5,6,4,4,7,4,6,8,6,6,10,5,9,5,7,8,5,8,6,6,8,8,4,9,6,7,9,9,10,9,6,8,8,7,8,4,7,8,4,7,7,5,8,7,7,6,8,8,8,7,7,1,7,8,8,5,3,3,3,6,6,7,6,5,7,6,5,5,6,4,2,7,8,4,10,6,2,3,7,7,6,7,7,7,6,7,5,3,8,6,3,6,3,7,5,7,7,4,5,7,3,6,1,5,7,4,7,6,5,7,3,1,8,6,7,7,3,5,8,5,7,8,8),
    '2-IA': (8,5,3,4,6,6,4,5,6,6,4,3,8,4,6,3,8,6,5,8,5,7,6,3,7,3,7,6,9,7,1,5,7,4,7,2,1,6,7,6,7,7,6,10,1,7,5,4,8,2,7,3,7,6,5,5,7,5,7,8,9,9,6,6,7,4,6,8,6,4,7,10,8,7,2,8,8,10,9,6,8,7,5,8,1,6,7,8,6,5,2,6,5,6,8,8,6,4,5,5,5,6,3,1,4,7,2,9,5,2,8,7,8,5,6,2,6,7,4,4,3,8,4,5,5,5,5,5,5,6,7,6,7,3,5,5,7,6,5,5,8,6,5,7,1,5,5,6,8,5,6,5,8,7,8,8),
    '3-H':  (6,5,5,5,6,7,2,5,5,7,4,7,7,4,9,2,7,6,4,8,7,9,7,2,8,2,7,7,7,6,2,7,6,4,7,5,2,6,7,6,8,5,10,8,1,7,6,8,7,1,7,6,7,6,7,7,7,5,9,8,9,9,5,7,7,8,8,5,6,5,7,8,5,6,4,8,7,9,7,7,5,8,6,7,1,9,7,8,4,3,5,4,8,7,8,6,9,5,6,4,6,4,5,5,6,6,7,8,7,1,6,7,5,5,4,4,7,6,6,6,5,7,8,5,7,7,6,2,3,6,7,10,6,3,7,2,8,7,6,6,7,5,5,7,1,9,4,5,7,4,6,5,8,7,8,6),
    '4-H':  (6,4,4,4,8,7,2,6,6,6,7,7,6,5,9,7,6,5,5,8,8,8,6,7,7,2,5,7,9,7,2,8,4,6,8,3,5,5,6,7,8,4,9,9,8,8,7,8,7,1,8,5,4,9,9,4,8,5,8,9,8,8,9,7,5,7,7,9,2,6,8,8,6,5,5,8,7,9,4,5,6,6,6,9,1,10,6,9,5,2,8,4,2,6,7,7,4,3,5,6,3,6,5,5,7,7,6,8,6,5,5,7,5,6,5,2,6,6,5,4,5,8,8,5,7,7,5,6,7,5,7,9,5,7,6,7,3,5,8,7,7,5,4,7,1,8,5,7,5,3,5,4,7,8,9,8),
    '5-IA': (8,5,1,2,7,5,6,2,6,4,2,5,6,5,6,2,3,4,5,8,3,6,4,6,7,2,5,4,8,5,1,5,7,5,8,7,1,4,1,6,8,7,8,9,3,8,4,7,5,4,6,2,2,9,6,5,7,3,6,7,8,7,6,4,6,4,8,9,2,8,6,1,3,5,3,7,5,9,3,5,6,7,5,6,1,7,8,7,4,4,2,1,2,4,6,7,8,3,5,3,3,5,2,1,3,6,2,6,6,3,2,5,4,4,5,4,6,6,4,2,1,6,4,6,5,2,1,2,7,5,6,4,5,3,3,4,4,3,3,7,5,6,6,1,1,5,5,3,8,1,5,4,8,7,7,6),
    '6-IA': (8,5,5,8,8,7,7,5,5,5,4,8,7,8,10,3,3,6,5,8,3,10,5,5,8,2,7,8,8,7,3,5,6,4,6,7,6,6,6,6,9,8,8,4,5,8,7,4,6,3,8,2,7,7,7,7,8,5,8,10,9,9,9,8,8,3,7,9,6,7,9,4,9,7,6,6,7,9,5,6,10,8,6,8,1,8,7,7,7,7,10,6,8,7,7,8,9,7,6,5,5,5,4,2,6,7,8,7,7,1,5,5,4,7,6,5,8,7,8,6,1,10,6,7,5,6,5,8,7,4,3,7,5,4,8,8,5,6,5,6,7,5,7,1,1,4,7,6,6,6,5,5,8,7,8,8),
    '7-IA': (6,3,3,9,8,7,8,6,5,8,3,4,6,4,10,4,6,6,6,6,5,10,7,4,8,2,6,7,9,6,2,5,5,6,5,2,4,6,4,7,7,9,8,4,5,7,5,4,8,1,8,2,4,6,9,7,7,6,7,9,8,9,5,6,9,2,8,8,4,5,8,10,5,7,4,5,7,9,3,8,6,8,6,8,3,10,7,8,5,4,8,3,4,5,6,5,8,6,4,5,3,4,5,5,5,7,8,7,5,1,7,5,5,5,6,7,4,6,2,7,1,8,6,6,6,7,6,7,7,4,9,8,5,4,6,7,5,8,7,6,7,6,7,7,1,8,6,3,5,4,3,8,8,7,8,7),
    '8-H':  (7, 6, 6, 4, 9, 5, 5, 7, 6, 9, 8, 8, 6, 6, 10, 5, 8, 8, 6, 7, 8, 8, 4, 10, 8, 2, 7, 7, 8, 5, 3, 8, 4, 6, 8, 7, 3, 5, 5, 4, 7, 8, 9, 10, 5, 7, 8, 8, 7, 4, 10, 3, 2, 6, 8, 6, 8, 5, 7, 9, 9, 9, 8, 6, 9, 9, 8, 8, 4, 8, 8, 10, 6, 6, 3, 6, 7, 9, 5, 6, 3, 8, 8, 9, 4, 6, 8, 7, 8, 2, 8, 7, 4, 7, 7, 6, 7, 7, 5, 7, 3, 7, 5, 5, 8, 7, 6, 8, 6, 4, 3, 7, 5, 7, 6, 8, 7, 7, 9, 8, 1, 8, 7, 5, 6, 8, 7, 3, 8, 5, 7, 1, 5, 5, 7, 5, 4, 4, 6, 3, 8, 4, 6, 7, 1, 10, 4, 7, 5, 3, 7, 3, 8, 8, 8, 6),
    '9-IA': (8, 5, 1, 2, 7, 7, 8, 5, 6, 5, 4, 2, 7, 3, 10, 3, 5, 7, 5, 7, 8, 9, 6, 8, 7, 1, 4, 6, 8, 6, 4, 5, 7, 4, 7, 8, 1, 5, 7, 4, 8, 7, 8, 6, 1, 8, 4, 5, 4, 1, 7, 2, 2, 7, 8, 3, 7, 4, 5, 8, 8, 9, 3, 5, 6, 6, 8, 8, 4, 3, 7, 1, 6, 6, 4, 7, 6, 9, 8, 7, 5, 6, 6, 8, 3, 4, 7, 4, 5, 6, 10, 3, 1, 6, 6, 8, 7, 4, 5, 4, 3, 5, 4, 5, 7, 8, 8, 5, 6, 2, 7, 7, 5, 2, 5, 4, 8, 8, 4, 4, 2, 7, 3, 6, 6, 8, 5, 8, 3, 6, 3, 1, 6, 2, 4, 5, 5, 8, 4, 5, 6, 6, 6, 1, 1, 5, 4, 4, 5, 4, 5, 2, 9, 8, 8, 8),
    '10-IA': (6, 3, 2, 6, 8, 8, 8, 6, 8, 8, 7, 3, 8, 4, 10, 3, 5, 7, 6, 8, 5, 10, 5, 9, 8, 2, 5, 8, 8, 7, 4, 8, 8, 3, 7, 8, 3, 6, 3, 6, 6, 8, 9, 10, 1, 8, 5, 8, 5, 3, 9, 3, 6, 6, 6, 4, 7, 7, 7, 9, 9, 9, 4, 5, 6, 8, 8, 7, 4, 6, 8, 8, 6, 6, 3, 8, 6, 10, 8, 7, 5, 7, 5, 8, 2, 4, 6, 5, 6, 7, 10, 7, 6, 7, 7, 8, 8, 6, 5, 3, 3, 6, 6, 2, 6, 8, 7, 6, 7, 2, 6, 6, 7, 8, 5, 3, 5, 8, 6, 4, 1, 6, 4, 5, 7, 8, 8, 4, 3, 5, 6, 7, 6, 4, 3, 7, 5, 8, 5, 6, 5, 5, 7, 7, 1, 8, 7, 5, 8, 4, 5, 2, 5, 8, 6, 8),
}

# EDADES: Cada elemento debe corresponder a la edad del participante i
edades_participantes = (60,25,19,25,19,24,19,21,29,27,21,20,30,21,20,24,23,21,29,39,25,25,24,23,24,32,32,28,22,23,26,21,30,21,24,21,25,24,23,34,25,19,18,20,22,29,18,25,18,24,19,21,31,19,19,27,21,32,34,27,19,31,24,31,24,27,47,21,45,19,22,24,25,61,39,38,38,32,30,25,29,25,31,21,24,25,52,30,32,32,32,39,38,31,36,27,22,22,40,19,26,23,23,28,31,22,43,30,25,24,26,41,41,27,24,27,28,24,26,22,39,22,25,22,39,27,24,23,25,61,35,24,56,23,21,24,21,27,21,30,29,58,62,60,58,25,26,37,48,49,59,25,62,64,25,25)  # ¡USAR TUS DATOS REALES AQUÍ!


# 1. Procesamiento de datos
data = []
for idx, edad in enumerate(edades_participantes):
    generacion = clasificar_generacion(edad)
    for estimulo, valores in respuestas.items():
        if idx < len(valores):
            data.append({
                'Estimulo': estimulo,
                'Tipo': 'Humano' if 'H' in estimulo else 'IA',
                'Valor': valores[idx],
                'Generacion': generacion
            })

df = pd.DataFrame(data)

# Limpieza de datos
df = df.replace([np.inf, -np.inf], np.nan)

# 2. Filtrar generaciones de interés
generaciones = ['Baby Boomers', 'Generación X', 'Millennials', 'Generación Z']
df_filtrado = df[df['Generacion'].isin(generaciones)]

# 3. Configuración de gráficos
n_estimulos = len(respuestas)
bar_width = 0.4
index = np.arange(n_estimulos)

fig, axs = plt.subplots(2, 2, figsize=(18, 12))
fig.suptitle('Puntuación Promedio por Estímulo y Generación', fontsize=16, y=1.02)

for i, gen in enumerate(generaciones):
    ax = axs[i//2, i%2]
    df_gen = df_filtrado[df_filtrado['Generacion'] == gen]
    
    # Calcular promedios manteniendo orden original
    promedios = df_gen.groupby(['Estimulo', 'Tipo'])['Valor'].mean().unstack()
    promedios = promedios.reindex(respuestas.keys())
    
    # Obtener valores y etiquetas
    humanos = promedios['Humano'].fillna(0).values
    ia = promedios['IA'].fillna(0).values
    etiquetas = [e.split('-')[0] for e in promedios.index]  # Simplifica etiquetas
    
    # Crear barras
    posiciones = index
    ax.bar(posiciones, humanos, bar_width, color='blue', alpha=0.7, label='Humano')
    ax.bar(posiciones, ia, bar_width, color='red', alpha=0.7, label='IA', bottom=humanos)
    
    # Personalización del gráfico
    ax.set_title(gen, fontsize=14, pad=15)
    ax.set_ylabel('Puntuación Promedio', fontsize=12)
    ax.set_xticks(posiciones)
    ax.set_xticklabels(etiquetas_x, rotation=45, ha='center', fontsize=10)  # Etiquetas horizontales y centradas
    ax.legend(fontsize=10, loc='upper right')
    ax.grid(axis='y', alpha=0.2)
    ax.set_ylim(0, 10)
    ax.set_xlim(-0.5, n_estimulos-0.5)  # Ajuste para centrar mejor las barras

plt.tight_layout(pad=3.0)
plt.show()